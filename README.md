[![Build Status](https://travis-ci.org/Edward-K1/MyDiary-API-Final.svg?branch=feature)](https://travis-ci.org/Edward-K1/MyDiary-API-Final)
[![Coverage Status](https://coveralls.io/repos/github/Edward-K1/MyDiary-API-Final/badge.svg?branch=feature)](https://coveralls.io/github/Edward-K1/MyDiary-API-Final?branch=feature)
[![Maintainability](https://api.codeclimate.com/v1/badges/3ef3d6259e631d10a56a/maintainability)](https://codeclimate.com/github/Edward-K1/MyDiary-API-Final/maintainability)


# MyDiary-API
This is an API to power MyDiary Front-End Pages

## Technologies used:
* Python 3
* Flask
* Virtualenv
* Postgres


## Getting Started:

Ensure the applications above are installed on your machine.

Clone the repo: `git clone https://github.com/Edward-K1/MyDiary-API-Final.git`

Create a virtual environment: `virtualenv venv`

Activate your virtual environment and install requirements:

(I'm assuming you're on windows)

```
$ cd venv/scripts
$ activate
$ cd ../..

$ pip install -r requirements.txt

```

## Setting up the database:

After installing and setting up postgresql, add the environment variable 'DATABASE_URL' to your environment and equate it to the connection string for the database.

The recommended format is: postgresql://user:password@host:port/database eg. `postgresql://postgres:postgres@localhost/mydiary` (the port is an optional parameter). This prevents incorrect formating of spaces and quotes especially in windows environments.

After setting up your environment, run this command while in the root directory to create the required tables:

`python v1/api/db.py`

## Running tests:

Open up a terminal and set the environment variable 'DATABASE_URL' to a different database for tests. When this value is not changed, the tests will run using the same database as the application. This will make the application fail if it cannot find the required tables. You'll have to re-run `python v1/api/db.py` in the application root to fix this.

To run the tests, open a terminal in the application root and run `pytest -v` or `nosetests -v`


## Features

The following endpoints are available:

|Http Method | Endpoint |  Functionality         | Status  |
|------------- | :-------------: |  -------------| -------------|
| POST   | /api/v1/auth/signup       |  Registers a new user          | Open |
| POST   | /api/v1/auth/login        |  Logins a new user             | Open |
| POST   | /api/v1/entries           |  Registers a new diary entry   | Protected |
| GET    | /api/v1/entries           |  Fetches a user's diary entries| Protected |
| GET    | /api/v1/entries/{entryId} | Gets a specific diary entry    | Protected |
| PUT    | /api/v1/entries/{entryId} | Modifies a diary entry         | Protected |
| DELETE | /api/v1/entries/{entryId} | Deletes a diary entry          | Protected |

### Required fields

* auth/signup  : {firstname, lastname, username, email, password}

* auth/login  : {email, password}

* /entries  : {title, content}

##### To access the protected routes, you'll need a Header named 'access-token' and the token generated by auth/login.

The API can be accessed via the following URLs:

* Locally: http://localhost:5000

* On Heroku: https://ch3-api.herokuapp.com

